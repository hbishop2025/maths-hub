<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="icon" type="image/svg" href="/assets/favicon.svg" />
  <title>SJWMS Maths ‚Äî Game Template</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>

  <!-- Shared layout / stripes / sidebar spacing -->
  <link rel="stylesheet" href="/assets/main.css"/>

  <style>
    :root{
      /* Neutral accent ‚Äì students can change this if they want */
      --accent:    #3B82F6; /* blue-500 */
      --accent-600:#2563EB;
      --accent-700:#1D4ED8;
    }
    body { font-family: 'Inter', sans-serif; }
    .material-icons { font-size: 24px; }
    html { scroll-behavior: smooth; }

    /* Optional: subtle neutral stripes for game pages */
    body[data-page="game-template"] .bg-stripes{
      position: relative;
      background: linear-gradient(135deg, #eff6ff, #ffffff); /* very light blue to white */
    }
    body[data-page="game-template"] .bg-stripes::after{
      content:"";
      position:absolute; inset:0; pointer-events:none;
      background: repeating-linear-gradient(
        -45deg,
        rgba(59,130,246,0.06) 0px,
        rgba(59,130,246,0.06) 8px,
        transparent 8px,
        transparent 16px
      );
      opacity:.7;
    }
  </style>
</head>

<body class="bg-gray-100"
      data-page="game-template">
  <div class="layout">
    <!-- Sidebar container (filled by sidebar-loader.js like the other pages) -->
    <div id="sidebar" aria-label="Sidebar"></div>

    <!-- Main content -->
    <main class="main p-8 overflow-y-auto">
      <!-- Top: back + title -->
      <header class="flex flex-wrap items-center justify-between gap-4 mb-6">
        <div class="flex items-center gap-3">
          <!-- TODO: change this link to wherever you want students to go back to (e.g. games hub) -->
          <a href="/index.html" class="inline-flex items-center text-gray-600 hover:text-gray-900">
            <span class="material-icons mr-1">arrow_back</span>
            Back to Maths Hub
          </a>
        </div>
      </header>

      <!-- Hero / Game header -->
      <section class="bg-white p-6 rounded-xl shadow-sm mb-6">
        <div class="flex items-start justify-between flex-wrap gap-4">
          <div>
            <!-- Students can edit all of this text -->
            <p class="uppercase tracking-wide text-xs text-gray-500 mb-1">
              Game Title
            </p>
            <h1 class="text-2xl md:text-3xl font-extrabold text-gray-800">
              Your Maths Game Name Here
            </h1>
            <p class="text-gray-600 mt-2 max-w-2xl">
              Describe what the game does and what maths it practises. You can explain the rules here
              in one or two sentences.
            </p>
          </div>

          <div class="flex flex-col items-end gap-2 text-sm text-gray-500">
            <!-- Optional ‚Äúmeta‚Äù area students can fill -->
            <div class="flex items-center gap-1">
              <span class="material-icons text-base text-gray-400">group</span>
              <span>Made by: <span class="font-semibold text-gray-800">Student Name(s)</span></span>
            </div>
            <div class="flex items-center gap-1">
              <span class="material-icons text-base text-gray-400">calculate</span>
              <span>Focus: <span class="font-semibold text-gray-800">e.g. Fractions / Algebra / Percentages</span></span>
            </div>
          </div>
        </div>
      </section>

      <!-- GAME AREA -->
      <section class="mt-6 grid grid-cols-1 lg:grid-cols-[minmax(0,3fr),minmax(0,2fr)] gap-6">
        <!-- Left: actual game -->
        <div class="bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-200">
          <h2 class="text-lg font-semibold text-gray-800 mb-3 flex items-center gap-2">
            <span class="material-icons text-[20px]" style="color:var(--accent);">sports_esports</span>
            Game Area
          </h2>

          <!--
            This is the ONLY bit students / AI really need to hook into.
            They can build anything they like inside #game-root using HTML + CSS + JS.
          -->
          <div id="game-root"
               class="bg-stripes rounded-xl min-h-[260px] md:min-h-[320px] flex items-center justify-center text-center px-4">
            <div class="max-w-md text-gray-700">
              <p class="font-semibold mb-2">
                Your game will appear here.
              </p>
              <p class="text-sm">
                Use JavaScript to update this area. For example, you can add buttons, questions,
                score counters and animations inside the <code>#game-root</code> element.
              </p>
              <p class="mt-3 text-xs text-gray-500">
                (If you‚Äôre using AI, tell it: ‚ÄúPut all the interactive game UI inside the
                &lt;div id=&quot;game-root&quot;&gt; on my existing page.‚Äù)
              </p>
            </div>
          </div>
        </div>

        <!-- Right: instructions / scoring / extension -->
        <div class="space-y-4">
          <div class="bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-200">
            <h2 class="text-lg font-semibold text-gray-800 mb-2 flex items-center gap-2">
              <span class="material-icons text-[20px] text-gray-500">menu_book</span>
              How to play
            </h2>
            <p class="text-sm text-gray-700">
              1. Explain the rules of your game here.<br>
              2. Say how players score points or win.<br>
              3. Mention any time limits or penalties.
            </p>
          </div>

          <div class="bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-200">
            <h2 class="text-lg font-semibold text-gray-800 mb-2 flex items-center gap-2">
              <span class="material-icons text-[20px] text-gray-500">psychology</span>
              Maths focus
            </h2>
            <p class="text-sm text-gray-700">
              Briefly describe the maths skills your game is practising. For example:
              fractions of amounts, solving equations, angles in triangles, etc.
            </p>
          </div>

          <div class="bg-white p-4 md:p-6 rounded-xl shadow-sm border border-gray-200">
            <h2 class="text-lg font-semibold text-gray-800 mb-2 flex items-center gap-2">
              <span class="material-icons text-[20px] text-gray-500">build</span>
              Extension ideas
            </h2>
            <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
              <li>Add levels that get harder.</li>
              <li>Keep track of high scores.</li>
              <li>Give hints, tips or solutions.</li>
              <li>Let the player choose topics or difficulty.</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- Spacer -->
      <div class="h-10"></div>
      <div id="chat-box" style="height: 300px; border: 1px solid #ccc; overflow-y: scroll; padding: 10px;"></div>
<input type="text" id="user-input" placeholder="Ask a maths question..." style="width: 70%;">
<button onclick="sendMessage()">Ask Tutor</button>

<script>
  let chatHistory = []; // Keeps track of conversation
  const WORKER_URL = "https://maths-tutor-bot.yourname.workers.dev"; // PASTE YOUR CLOUDFLARE URL HERE

  async function sendMessage() {
    const input = document.getElementById("user-input");
    const message = input.value;
    const chatBox = document.getElementById("chat-box");

    // 1. Show user message
    chatBox.innerHTML += `<p><strong>You:</strong> ${message}</p>`;
    input.value = "";

    // 2. Send to YOUR Cloudflare Worker (Not Google directly!)
    try {
      const response = await fetch(WORKER_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message: message, history: chatHistory })
      });

      const data = await response.json();
      const botReply = data.candidates[0].content.parts[0].text;

      // 3. Show Bot Reply
      chatBox.innerHTML += `<p style="color: blue;"><strong>Tutor:</strong> ${botReply}</p>`;
      
      // 4. Update History (so bot remembers context)
      chatHistory.push({ role: "user", parts: [{ text: message }] });
      chatHistory.push({ role: "model", parts: [{ text: botReply }] });

    } catch (error) {
      chatBox.innerHTML += `<p style="color: red;">Error: Could not reach the tutor.</p>`;
    }
  }
</script>
    </main>
  </div>


  <!-- Shared scripts (sidebar + any global helpers you already use) -->
  <script src="/assets/sidebar-loader.js"></script>

  <!-- === GAME SCRIPT AREA ===
       Students / AI should add their JavaScript BELOW this comment.
       They can select #game-root and build everything inside it.
  -->
  <script>
    // Simple example to show how to hook into the page.
    // Students can delete this and write their own game logic.

    (function () {
      const root = document.getElementById("game-root");
      if (!root) return;

      // Clear the placeholder text
      root.innerHTML = "";

      // Example: a very basic quiz shell
      const container = document.createElement("div");
      container.className = "max-w-md w-full bg-white/90 rounded-xl shadow p-4 md:p-6";

      container.innerHTML = `
        <h2 class="text-lg font-semibold mb-3 text-gray-800">Example: Quick Maths Quiz</h2>
        <p class="text-sm text-gray-700 mb-3">
          This is just a demo. Replace it with your own game logic.
        </p>
        <div class="flex flex-col gap-2">
          <label class="text-sm text-gray-700">
            What is <span class="font-mono font-semibold">7 √ó 8</span>?
          </label>
          <input id="answer-input"
                 type="number"
                 class="border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-blue-400"
                 placeholder="Type your answer here">
          <button id="check-btn"
                  class="mt-2 inline-flex items-center justify-center px-4 py-2 rounded-lg text-sm font-semibold text-white"
                  style="background: var(--accent);">
            Check answer
          </button>
          <p id="feedback" class="mt-2 text-sm text-gray-700"></p>
        </div>
      `;

      root.appendChild(container);

      const input = container.querySelector("#answer-input");
      const btn = container.querySelector("#check-btn");
      const feedback = container.querySelector("#feedback");

      btn.addEventListener("click", () => {
        const value = Number(input.value);
        if (!input.value) {
          feedback.textContent = "Type an answer first.";
          feedback.className = "mt-2 text-sm text-amber-600";
          return;
        }
        if (value === 56) {
          feedback.textContent = "Correct! üéâ";
          feedback.className = "mt-2 text-sm text-emerald-600 font-semibold";
        } else {
          feedback.textContent = "Not quite. Try again.";
          feedback.className = "mt-2 text-sm text-rose-600";
        }
      });
    })();
  </script>
</body>
</html>
