<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>KS3 Hub</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>

  <!-- Shared CSS -->
  <link rel="stylesheet" href="assets/main.css"/>
</head>
<body class="bg-gray-100" data-page="ks3">
  <div class="layout">
    <!-- Sidebar -->
    <div id="sidebar" aria-label="Sidebar"></div>

    <!-- Main -->
    <main class="main p-8 overflow-y-auto">
      <!-- Header -->
      <header class="flex flex-wrap items-center justify-between gap-4 mb-8">
        <div class="flex items-center gap-3">
          <a href="index.html" class="inline-flex items-center text-gray-600 hover:text-gray-900">
            <span class="material-icons mr-1">arrow_back</span> Back to Explore
          </a>
        </div>
        <h1 class="text-2xl font-extrabold text-gray-800">KS3 Hub</h1>
      </header>

      <!-- Hero row: left = welcome (from JSON), right = EOY box (edit text in file or CMS if you like) -->
      <section class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
        <!-- Welcome -->
        <article class="bg-white rounded-2xl shadow-sm p-6">
          <div class="flex items-start gap-4">
            <span class="material-icons text-5xl text-gray-800">tips_and_updates</span>
            <div>
              <h2 id="ks3-hero-title" class="text-xl font-bold text-gray-800 mb-1">Welcome to KS3</h2>
              <p id="ks3-hero-sub" class="text-gray-600">
                A single place for Year 7–9 resources. Choose your year below.
              </p>
            </div>
          </div>
        </article>

        <!-- EOY -->
        <article class="rounded-2xl p-6 text-white" style="background:#1F2937">
          <div class="flex items-start gap-4">
            <span class="material-icons text-5xl text-white/90">event</span>
            <div class="flex-1">
              <h2 class="text-xl font-bold mb-1">End of Year Exams</h2>
              <p class="text-white/80 mb-3">
                Guidance and revision resources for KS3 end-of-year exams.
              </p>
              <a href="ks3_eoy.html" class="inline-flex items-center px-4 py-2 rounded-lg bg-white text-gray-900 font-semibold">
                View EOY Resources <span class="material-icons ml-2">arrow_forward</span>
              </a>
            </div>
          </div>
        </article>
      </section>

      <!-- Year cards (no flip, equal size) -->
      <section class="mb-10" aria-label="Choose a year">
        <h2 class="text-2xl font-bold text-gray-800 mb-4">Choose your year</h2>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 auto-rows-[14rem]">
          <!-- Year 7 -->
          <a href="year7_hub.html"
             class="group block h-full rounded-2xl bg-white shadow-sm border border-gray-200 hover:shadow-md transition p-6">
            <div class="h-full flex flex-col">
              <div class="w-12 h-12 rounded-xl flex items-center justify-center mb-4" style="background:#FFEDD5;">
                <span class="material-icons" style="color:#F97316;">school</span>
              </div>
              <h3 class="text-lg font-bold text-gray-800">Year 7</h3>
              <p class="text-sm text-gray-600 mt-1">
                Topics, worksheets, videos, and more.
              </p>
              <div class="mt-auto pt-3">
                <span class="inline-flex items-center font-semibold text-blue-600">
                  Open <span class="material-icons ml-1">arrow_forward</span>
                </span>
              </div>
            </div>
          </a>

          <!-- Year 8 -->
          <a href="year8_hub.html"
             class="group block h-full rounded-2xl bg-white shadow-sm border border-gray-200 hover:shadow-md transition p-6">
            <div class="h-full flex flex-col">
              <div class="w-12 h-12 rounded-xl flex items-center justify-center mb-4" style="background:#DCFCE7;">
                <span class="material-icons" style="color:#16A34A;">school</span>
              </div>
              <h3 class="text-lg font-bold text-gray-800">Year 8</h3>
              <p class="text-sm text-gray-600 mt-1">
                Consolidate and build on foundations.
              </p>
              <div class="mt-auto pt-3">
                <span class="inline-flex items-center font-semibold text-blue-600">
                  Open <span class="material-icons ml-1">arrow_forward</span>
                </span>
              </div>
            </div>
          </a>

          <!-- Year 9 -->
          <a href="year9_hub.html"
             class="group block h-full rounded-2xl bg-white shadow-sm border border-gray-200 hover:shadow-md transition p-6">
            <div class="h-full flex flex-col">
              <div class="w-12 h-12 rounded-xl flex items-center justify-center mb-4" style="background:#EDE9FE;">
                <span class="material-icons" style="color:#7B61FF;">school</span>
              </div>
              <h3 class="text-lg font-bold text-gray-800">Year 9</h3>
              <p class="text-sm text-gray-600 mt-1">
                Final KS3 year: prepare and push further.
              </p>
              <div class="mt-auto pt-3">
                <span class="inline-flex items-center font-semibold text-blue-600">
                  Open <span class="material-icons ml-1">arrow_forward</span>
                </span>
              </div>
            </div>
          </a>
        </div>
      </section>

      <!-- KS3 Featured Sites (CMS-controlled) -->
      <section class="mt-10">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-2xl font-bold text-gray-800">KS3 Featured Sites</h2>
        </div>
        <div id="ks3-featured-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"></div>
        <p id="ks3-featured-empty" class="text-gray-500" hidden>No featured sites yet.</p>
      </section>
    </main>
  </div>

    <!-- Split hero: UKMT (light) + AI usage (dark) -->
<section class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-10">
  <!-- UKMT promo (light) -->
  <article class="bg-white rounded-2xl shadow-sm p-6">
    <div class="flex items-start gap-4">
      <span class="material-icons text-5xl text-gray-800">emoji_events</span>
      <div>
        <h2 id="ks3-ukmt-title" class="text-xl font-bold text-gray-800 mb-1">UKMT at KS3</h2>
        <p id="ks3-ukmt-sub" class="text-gray-600">
          Prepare for the Junior/Intermediate Maths Challenges with hand-picked resources.
        </p>
      </div>
    </div>
  </article>

  <!-- AI usage (dark) -->
  <article class="rounded-2xl p-6 text-white" style="background:#1F2937">
    <div class="flex items-start gap-4">
      <span class="material-icons text-5xl text-white/90">psychology</span>
      <div class="flex-1">
        <h2 class="text-xl font-bold mb-1">Do you know how to use AI?</h2>
        <p class="text-white/80 mb-3">
          Tips, examples and boundaries for using AI safely and effectively in maths.
        </p>
        <a href="ai_usage.html" class="inline-flex items-center px-4 py-2 rounded-lg bg-white text-gray-900 font-semibold">
          Open AI Guidance <span class="material-icons ml-2">arrow_forward</span>
        </a>
      </div>
    </div>
  </article>
</section>

<!-- UKMT resources (CMS) -->
<section class="mt-8">
  <div class="flex items-center justify-between mb-4">
    <h2 class="text-2xl font-bold text-gray-800">UKMT Preparation</h2>
  </div>
  <div id="ks3-ukmt-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"></div>
  <p id="ks3-ukmt-empty" class="text-gray-500" hidden>No UKMT items yet.</p>
</section>

<!-- Problem Solver (CMS) -->
<section class="mt-8">
  <div class="flex items-center justify-between mb-4">
    <h2 class="text-2xl font-bold text-gray-800">Problem Solver</h2>
  </div>
  <div id="ks3-problems-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"></div>
  <p id="ks3-problems-empty" class="text-gray-500" hidden>No problems yet.</p>
</section>
  
  <!-- Shared scripts -->
  <script src="assets/sidebar-loader.js"></script>
  <script src="assets/cards.js"></script>

  <script>
    // JSON sources (all Decap-managed)
    const KS3_HERO_JSON   = "assets/data/ks3_hero.json";
    const KS3_SITES_JSON  = "assets/data/ks3_featured_sites.json";

    // ---- Hero text ----
    fetch(KS3_HERO_JSON, {cache:"no-store"})
      .then(r => r.json())
      .then(d => {
        // Support either {title, subtitle} or {headline, body}
        const title = d.title || d.headline || "Welcome to KS3";
        const sub   = d.subtitle || d.body || "A single place for Year 7–9 resources. Choose your year below.";
        document.getElementById("ks3-hero-title").textContent = title;
        document.getElementById("ks3-hero-sub").textContent   = sub;
      })
      .catch(()=>{});

    // Helper: tolerate array or {items:[]}
    function normList(data){
      if(Array.isArray(data)) return data;
      if(data && Array.isArray(data.items)) return data.items;
      return [];
    }

    // ---- KS3 Featured Sites (reuse makeSiteCard from assets/cards.js) ----
    async function loadKS3Sites(){
      try{
        const res = await fetch(KS3_SITES_JSON, {cache:"no-store"});
        const data = await res.json();
        const items = normList(data).filter(x => x && x.active !== false);

        const grid = document.getElementById("ks3-featured-grid");
        grid.innerHTML = "";
        items.forEach(site => grid.appendChild(makeSiteCard(site)));

        document.getElementById("ks3-featured-empty").hidden = items.length > 0;
      }catch(e){
        console.error("KS3 featured sites load error:", e);
        document.getElementById("ks3-featured-empty").hidden = false;
      }
    }

    document.addEventListener("DOMContentLoaded", loadKS3Sites);
  </script>
</body>
</html>
