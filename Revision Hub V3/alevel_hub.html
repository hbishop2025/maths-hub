<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>A-Level | Home</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;600;700;800;900&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>

  <style type="text/tailwindcss">
    body { @apply bg-[#f6f6f8] text-[#111827] font-[Lexend]; }

    .math-grid {
      background-image:
        radial-gradient(circle at 1px 1px, rgba(0,0,0,0.05) 1px, transparent 0),
        radial-gradient(circle at 1px 1px, rgba(0,0,0,0.05) 1px, transparent 0);
      background-size: 40px 40px;
      background-position: 0 0, 20px 20px;
      mask-image: linear-gradient(to bottom, white 65%, transparent 100%);
    }

    .header { @apply fixed top-0 left-0 right-0 z-30 bg-white/85 backdrop-blur border-b border-gray-200; }

    /* Hero */
    .hero-wrap{
      margin-top: 3.5rem;
      position: relative;
      border-radius: 1.75rem;
      overflow: hidden;
      background: #0f172a;
      height: 300px;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow:
        0 22px 45px rgba(15,23,42,0.4),
        0 0 0 1px rgba(15,23,42,0.5);
    }

    .hero-bg{
      position:absolute;
      inset:0;
      overflow:hidden;
      border-radius: inherit;
    }
    .hero-bg img{
      width:100%;
      height:100%;
      object-fit:cover;
      filter: brightness(.7) saturate(1.1);
      transform: scale(1.05);
    }

    .hero-overlay{
      position:absolute;
      inset:0;
      background:
        linear-gradient(to bottom, rgba(15,23,42,.55), rgba(15,23,42,.45)),
        radial-gradient(circle at top left, rgba(124,58,237,.18), transparent 60%);
    }

    /* Hero text */
    .hero-title{
      position:relative;
      text-align:center;
      color:white;
    }
    .hero-title h1{
      @apply text-5xl sm:text-6xl font-black tracking-tight;
    }
    .hero-title h2{
      @apply text-xl font-semibold tracking-wide opacity-90 mt-2;
    }

    /* Track pills */
    .track-wrap{
      @apply flex flex-wrap justify-center gap-3 mt-8;
    }
    .track-pill{
      @apply px-4 py-2 rounded-full text-sm font-semibold border
               bg-white shadow-sm cursor-pointer transition;
      border-color: rgba(148,163,184,0.35);
      color: #111827;
    }
    .track-pill:hover{
      @apply bg-slate-50 border-slate-300;
    }
    .track-pill-active{
      @apply bg-slate-900 text-white border-slate-900 shadow-md;
    }
    /* Active pill should NOT lighten on hover */
    .track-pill-active:hover {
      background-color: #0f172a !important;
      border-color: #0f172a !important;
      color: white !important;
      cursor: default;
    }

    /* Cards */
    .icon-card{
      @apply flex flex-col items-center justify-center p-6 rounded-2xl
             bg-white border border-gray-200 shadow-sm transition;
    }
    .icon-card:hover{
      @apply shadow-md -translate-y-1;
    }

    .panel-heading{
      @apply text-base sm:text-lg font-semibold text-gray-900 mb-2 flex items-center gap-2;
    }
    .panel-sub{
      @apply text-xs text-gray-500 mb-4;
    }
  </style>
</head>
<body>

<!-- HEADER -->
<header class="header">
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 h-14 flex items-center justify-between relative">
    <div class="flex items-center gap-3">
      <img src="assets/hub_logo.png" alt="SJWMS" class="h-7"/>
      <span class="font-extrabold tracking-tight">SJWMS Maths</span>
    </div>

    <nav class="hidden md:flex items-center gap-6">
      <a class="text-sm font-medium text-gray-700 hover:text-[#135bec]" href="index.html">Home</a>
      <a class="text-sm font-medium text-gray-700 hover:text-[#135bec]" href="ks3_hub.html">KS3</a>
      <a class="text-sm font-medium text-gray-700 hover:text-[#135bec]" href="gcse_hub.html">GCSE</a>
      <a class="text-sm font-medium text-[#135bec]" href="#">A-Level</a>
      <a class="px-4 py-2 rounded-full bg-[#111827] text-white text-sm font-semibold" href="ai_usage.html">AI Usage</a>
    </nav>
  </div>
</header>

<!-- Background -->
<div class="absolute inset-0 math-grid pointer-events-none"></div>

<!-- MAIN -->
<main class="relative pt-20 pb-16">
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">

    <!-- HERO -->
    <section class="hero-wrap">
      <div class="hero-bg">
        <img src="assets/alevel-hero.jpg" alt="A-Level Maths background">
      </div>
      <div class="hero-overlay"></div>

      <div class="hero-title">
        <h1>A-Level</h1>
        <h2>Maths</h2>

        <!-- Hero buttons -->
        <div class="mt-8 flex flex-wrap justify-center gap-4">
          <a href="https://sites.google.com/sjwms.org.uk/mathsatthemath/exam-revision"
             class="inline-flex items-center gap-2 px-5 py-2.5 rounded-full border border-white/20 
                    bg-white/10 backdrop-blur-sm text-white text-sm font-semibold 
                    hover:bg-white/20 transition">
            Exam Revision
            <span class="material-symbols-outlined text-base">menu_book</span>
          </a>

          <a href="https://sites.google.com/sjwms.org.uk/mathsatthemath/papers/a-questions"
             class="inline-flex items-center gap-2 px-5 py-2.5 rounded-full border border-white/20 
                    bg-white/10 backdrop-blur-sm text-white text-sm font-semibold 
                    hover:bg-white/20 transition">
            A* Questions
            <span class="material-symbols-outlined text-base">edit_note</span>
          </a>
        </div>
      </div>
    </section>

    <!-- Track selector (NOW DYNAMIC) -->
    <div class="track-wrap" id="track-pill-wrap">
      <!-- Pills will be injected here from JSON -->
    </div>

    <!-- PANELS â€“ dynamic content root -->
    <section id="track-panels" class="mt-10 space-y-8">
      <!-- Track sections + cards will be injected here from JSON -->
    </section>

  </div>
</main>

<!-- FOOTER -->
<div id="footer-slot"></div>
<script src="assets/footer-loader.js" defer></script>

<!-- TRACKS FROM JSON -->
<script>
  (function(){
    const PILL_WRAP = document.getElementById('track-pill-wrap');
    const PANEL_ROOT = document.getElementById('track-panels');
    const JSON_URL = '/assets/data/alevel_tracks.json'; // <- your JSON file

    let TRACKS = [];
    let activeTrackId = null;

    function createPills(tracks){
      PILL_WRAP.innerHTML = '';
      tracks.forEach((track, index) => {
        const btn = document.createElement('button');
        btn.className = 'track-pill' + (index === 0 ? ' track-pill-active' : '');
        btn.dataset.trackId = track.id;
        btn.textContent = track.label;
        btn.addEventListener('click', () => {
          if (activeTrackId === track.id) return;
          setActiveTrack(track.id);
        });
        PILL_WRAP.appendChild(btn);
      });
    }

    function setActiveTrack(id){
      activeTrackId = id;

      // pills
      const pills = PILL_WRAP.querySelectorAll('.track-pill');
      pills.forEach(pill => {
        const isActive = pill.dataset.trackId === id;
        pill.classList.toggle('track-pill-active', isActive);
      });

      // panels
      renderTrack(id);
    }

    function renderTrack(id){
      const track = TRACKS.find(t => t.id === id);
      if (!track){
        PANEL_ROOT.innerHTML = '<p class="text-sm text-slate-500">Nothing here yet.</p>';
        return;
      }

      const sections = Array.isArray(track.sections) ? track.sections : [];

      if (!sections.length){
        PANEL_ROOT.innerHTML = '<p class="text-sm text-slate-500">Content coming soon for this track.</p>';
        return;
      }

      const html = sections.map(section => {
        const cards = Array.isArray(section.cards) ? section.cards : [];

        const cardsHtml = cards.map(card => {
          const icon = card.icon || 'auto_awesome';
          const title = card.title || 'Untitled card';
          const desc = card.description || '';
          const url  = card.url || '';

          const isLink = !!url;
          const tagHtml = Array.isArray(card.tags) && card.tags.length
            ? '<div class="mt-3 flex flex-wrap justify-center gap-1">' +
                card.tags.map(t => 
                  `<span class="inline-flex items-center px-2 py-0.5 rounded-full bg-slate-50 text-[10px] font-semibold text-slate-500 border border-slate-100">${t}</span>`
                ).join('') +
              '</div>'
            : '';

          const inner = `
            <span class="material-symbols-outlined text-4xl text-slate-500 group-hover:text-slate-700">${icon}</span>
            <p class="mt-3 text-sm text-slate-800 font-semibold text-center">${title}</p>
            <p class="mt-1 text-xs text-slate-500 text-center">${desc}</p>
            ${tagHtml}
          `;

          if (isLink){
            return `
              <a href="${url}" target="_blank" rel="noopener"
                 class="icon-card group">
                ${inner}
              </a>
            `;
          } else {
            return `<div class="icon-card group">${inner}</div>`;
          }
        }).join('');

        return `
          <section class="space-y-2">
            <h3 class="panel-heading">
              ${section.heading || ''}
            </h3>
            ${section.subheading ? `<p class="panel-sub">${section.subheading}</p>` : ''}
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
              ${cardsHtml}
            </div>
          </section>
        `;
      }).join('');

      PANEL_ROOT.innerHTML = html;
    }

    // Load JSON + initialise
    fetch(JSON_URL, { cache: 'no-store' })
      .then(r => r.json())
      .then(data => {
        TRACKS = Array.isArray(data.tracks) ? data.tracks : [];
        if (!TRACKS.length){
          PANEL_ROOT.innerHTML = '<p class="text-sm text-slate-500">No tracks found in alevel_tracks.json.</p>';
          return;
        }
        createPills(TRACKS);
        setActiveTrack(TRACKS[0].id); // default to first track (Y12 Pure)
      })
      .catch(err => {
        console.error('Error loading A-level tracks JSON', err);
        PANEL_ROOT.innerHTML =
          '<p class="text-sm text-red-600">There was a problem loading the A-level hub data. Check alevel_tracks.json.</p>';
      });
  })();
</script>

</body>
</html>
